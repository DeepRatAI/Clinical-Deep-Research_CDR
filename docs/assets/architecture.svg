<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 520" font-family="Inter, system-ui, -apple-system, sans-serif">
  <defs>
    <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
    <linearGradient id="nodeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#2563eb"/>
    </linearGradient>
    <linearGradient id="nodeGradGreen" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#22c55e"/>
      <stop offset="100%" style="stop-color:#16a34a"/>
    </linearGradient>
    <linearGradient id="nodeGradAmber" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="nodeGradPurple" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#a855f7"/>
      <stop offset="100%" style="stop-color:#7c3aed"/>
    </linearGradient>
    <linearGradient id="nodeGradRed" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ef4444"/>
      <stop offset="100%" style="stop-color:#dc2626"/>
    </linearGradient>
    <filter id="shadow" x="-10%" y="-10%" width="130%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.3" flood-color="#000"/>
    </filter>
    <marker id="arrowBlue" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#60a5fa"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="960" height="520" fill="url(#bg)" rx="12"/>

  <!-- Title -->
  <text x="480" y="38" text-anchor="middle" fill="#e2e8f0" font-size="18" font-weight="700" letter-spacing="0.5">CDR Pipeline — 13-Node LangGraph StateGraph</text>
  <text x="480" y="56" text-anchor="middle" fill="#94a3b8" font-size="11">Clinical Deep Research v0.1 · Systematic Review Automation</text>

  <!-- === ROW 1: Retrieval Phase === -->
  <!-- Input -->
  <rect x="30" y="90" width="120" height="44" rx="22" fill="none" stroke="#60a5fa" stroke-width="1.5" stroke-dasharray="5,3"/>
  <text x="90" y="116" text-anchor="middle" fill="#93c5fd" font-size="11" font-weight="600">Clinical Question</text>

  <line x1="150" y1="112" x2="172" y2="112" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- parse_question -->
  <rect x="178" y="90" width="120" height="44" rx="8" fill="url(#nodeGrad)" filter="url(#shadow)"/>
  <text x="238" y="108" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">① parse_question</text>
  <text x="238" y="122" text-anchor="middle" fill="#bfdbfe" font-size="9">→ PICO extraction</text>

  <line x1="298" y1="112" x2="318" y2="112" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- plan_search -->
  <rect x="324" y="90" width="120" height="44" rx="8" fill="url(#nodeGrad)" filter="url(#shadow)"/>
  <text x="384" y="108" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">② plan_search</text>
  <text x="384" y="122" text-anchor="middle" fill="#bfdbfe" font-size="9">→ PubMed queries</text>

  <line x1="444" y1="112" x2="464" y2="112" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- retrieve -->
  <rect x="470" y="90" width="120" height="44" rx="8" fill="url(#nodeGrad)" filter="url(#shadow)"/>
  <text x="530" y="108" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">③ retrieve</text>
  <text x="530" y="122" text-anchor="middle" fill="#bfdbfe" font-size="9">PubMed + CT.gov</text>

  <line x1="590" y1="112" x2="610" y2="112" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- deduplicate -->
  <rect x="616" y="90" width="120" height="44" rx="8" fill="url(#nodeGrad)" filter="url(#shadow)"/>
  <text x="676" y="108" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">④ deduplicate</text>
  <text x="676" y="122" text-anchor="middle" fill="#bfdbfe" font-size="9">Fuzzy + exact dedup</text>

  <!-- Phase label -->
  <text x="890" y="105" text-anchor="end" fill="#475569" font-size="10" font-weight="600" transform="rotate(-90,900,105)">RETRIEVAL</text>

  <!-- === ROW 2: Screening Phase === -->
  <path d="M736,112 L760,112 Q775,112 775,127 L775,200 Q775,215 760,215 L302,215" fill="none" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- screen -->
  <rect x="178" y="193" width="120" height="44" rx="8" fill="url(#nodeGradAmber)" filter="url(#shadow)"/>
  <text x="238" y="211" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">⑤ screen</text>
  <text x="238" y="225" text-anchor="middle" fill="#fef3c7" font-size="9">PICO matching</text>

  <line x1="298" y1="215" x2="318" y2="215" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- parse_docs -->
  <rect x="324" y="193" width="120" height="44" rx="8" fill="url(#nodeGradAmber)" filter="url(#shadow)"/>
  <text x="384" y="211" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">⑥ parse_docs</text>
  <text x="384" y="225" text-anchor="middle" fill="#fef3c7" font-size="9">Fulltext extraction</text>

  <line x1="444" y1="215" x2="464" y2="215" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- extract_data -->
  <rect x="470" y="193" width="120" height="44" rx="8" fill="url(#nodeGradAmber)" filter="url(#shadow)"/>
  <text x="530" y="211" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">⑦ extract_data</text>
  <text x="530" y="225" text-anchor="middle" fill="#fef3c7" font-size="9">→ StudyCards</text>

  <text x="890" y="208" text-anchor="end" fill="#475569" font-size="10" font-weight="600" transform="rotate(-90,900,208)">SCREENING</text>

  <!-- === ROW 3: Analysis Phase === -->
  <path d="M590,215 L615,215 Q630,215 630,230 L630,305 Q630,320 615,320 L302,320" fill="none" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- assess_rob2 -->
  <rect x="178" y="298" width="120" height="44" rx="8" fill="url(#nodeGradPurple)" filter="url(#shadow)"/>
  <text x="238" y="316" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">⑧ assess_rob2</text>
  <text x="238" y="330" text-anchor="middle" fill="#e9d5ff" font-size="9">5-domain bias</text>

  <line x1="298" y1="320" x2="318" y2="320" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- synthesize -->
  <rect x="324" y="298" width="120" height="44" rx="8" fill="url(#nodeGradPurple)" filter="url(#shadow)"/>
  <text x="384" y="316" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">⑨ synthesize</text>
  <text x="384" y="330" text-anchor="middle" fill="#e9d5ff" font-size="9">→ EvidenceClaims</text>

  <line x1="444" y1="320" x2="464" y2="320" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- critique -->
  <rect x="470" y="298" width="120" height="44" rx="8" fill="url(#nodeGradRed)" filter="url(#shadow)"/>
  <text x="530" y="316" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">⑩ critique</text>
  <text x="530" y="330" text-anchor="middle" fill="#fecaca" font-size="9">Skeptic agent</text>

  <text x="890" y="311" text-anchor="end" fill="#475569" font-size="10" font-weight="600" transform="rotate(-90,900,311)">ANALYSIS</text>

  <!-- === ROW 4: Verification & Output === -->
  <path d="M590,320 L615,320 Q630,320 630,335 L630,415 Q630,430 615,430 L302,430" fill="none" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- verify -->
  <rect x="178" y="408" width="120" height="44" rx="8" fill="url(#nodeGradGreen)" filter="url(#shadow)"/>
  <text x="238" y="426" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">⑪ verify</text>
  <text x="238" y="440" text-anchor="middle" fill="#bbf7d0" font-size="9">Entailment check</text>

  <line x1="298" y1="430" x2="318" y2="430" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- compose -->
  <rect x="324" y="408" width="120" height="44" rx="8" fill="url(#nodeGradGreen)" filter="url(#shadow)"/>
  <text x="384" y="426" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">⑫ compose</text>
  <text x="384" y="440" text-anchor="middle" fill="#bbf7d0" font-size="9">A+B⇒C hypotheses</text>

  <line x1="444" y1="430" x2="464" y2="430" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- publish -->
  <rect x="470" y="408" width="120" height="44" rx="8" fill="url(#nodeGradGreen)" filter="url(#shadow)"/>
  <text x="530" y="426" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">⑬ publish</text>
  <text x="530" y="440" text-anchor="middle" fill="#bbf7d0" font-size="9">MD / JSON / HTML</text>

  <line x1="590" y1="430" x2="610" y2="430" stroke="#60a5fa" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- Output -->
  <rect x="616" y="408" width="140" height="44" rx="22" fill="none" stroke="#22c55e" stroke-width="1.5" stroke-dasharray="5,3"/>
  <text x="686" y="426" text-anchor="middle" fill="#86efac" font-size="10" font-weight="600">Structured Report</text>
  <text x="686" y="440" text-anchor="middle" fill="#6ee7b7" font-size="9">+ PRISMA + Audit</text>

  <text x="890" y="420" text-anchor="end" fill="#475569" font-size="10" font-weight="600" transform="rotate(-90,900,420)">OUTPUT</text>

  <!-- External services -->
  <rect x="30" y="380" width="130" height="72" rx="6" fill="none" stroke="#334155" stroke-width="1" stroke-dasharray="4,3"/>
  <text x="95" y="398" text-anchor="middle" fill="#64748b" font-size="9" font-weight="600">External APIs</text>
  <text x="95" y="413" text-anchor="middle" fill="#475569" font-size="8">PubMed · CT.gov</text>
  <text x="95" y="426" text-anchor="middle" fill="#475569" font-size="8">PMC Open Access</text>
  <text x="95" y="439" text-anchor="middle" fill="#475569" font-size="8">8 LLM providers</text>

  <!-- Legend -->
  <rect x="30" y="470" width="12" height="12" rx="3" fill="url(#nodeGrad)"/>
  <text x="48" y="481" fill="#94a3b8" font-size="9">Retrieval</text>
  <rect x="110" y="470" width="12" height="12" rx="3" fill="url(#nodeGradAmber)"/>
  <text x="128" y="481" fill="#94a3b8" font-size="9">Screening</text>
  <rect x="200" y="470" width="12" height="12" rx="3" fill="url(#nodeGradPurple)"/>
  <text x="218" y="481" fill="#94a3b8" font-size="9">Analysis</text>
  <rect x="280" y="470" width="12" height="12" rx="3" fill="url(#nodeGradRed)"/>
  <text x="298" y="481" fill="#94a3b8" font-size="9">Critique</text>
  <rect x="355" y="470" width="12" height="12" rx="3" fill="url(#nodeGradGreen)"/>
  <text x="373" y="481" fill="#94a3b8" font-size="9">Verification &amp; Output</text>

  <text x="930" y="500" text-anchor="end" fill="#334155" font-size="9">CDR v0.1 Open Alpha · Apache-2.0</text>
</svg>
